(function(){"use strict";var e={3162:function(e,t,n){var o=n(5130),a=n(6768);const r={id:"app"},s={key:0},l={key:0},i={key:1},d={key:1};function u(e,t,n,o,u,c){const m=(0,a.g2)("router-link"),h=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",r,[u.isLoggedIn?((0,a.uX)(),(0,a.CE)("nav",s,[(0,a.Lk)("ul",null,[u.isAdmin?((0,a.uX)(),(0,a.CE)("li",l,[(0,a.bF)(m,{to:"/user-management"},{default:(0,a.k6)((()=>[(0,a.eW)("User Management")])),_:1})])):(0,a.Q3)("",!0),u.isAdmin?((0,a.uX)(),(0,a.CE)("li",i,[(0,a.bF)(m,{to:"/data-management"},{default:(0,a.k6)((()=>[(0,a.eW)("Data Management")])),_:1})])):(0,a.Q3)("",!0),(0,a.Lk)("li",null,[(0,a.bF)(m,{to:"/chat"},{default:(0,a.k6)((()=>[(0,a.eW)("Chat")])),_:1})]),(0,a.Lk)("li",null,[(0,a.Lk)("a",{href:"#",onClick:t[0]||(t[0]=(...e)=>c.logout&&c.logout(...e))},"Logout")])])])):((0,a.uX)(),(0,a.CE)("nav",d,[(0,a.Lk)("ul",null,[(0,a.Lk)("li",null,[(0,a.bF)(m,{to:"/register"},{default:(0,a.k6)((()=>[(0,a.eW)("Register")])),_:1})]),(0,a.Lk)("li",null,[(0,a.bF)(m,{to:"/login"},{default:(0,a.k6)((()=>[(0,a.eW)("Login")])),_:1})])])])),(0,a.bF)(h)])}n(4114),n(4979);var c={name:"App",data(){return{isLoggedIn:!!localStorage.getItem("token"),isAdmin:!1}},watch:{$route(){this.updateAuthStatus()}},methods:{updateAuthStatus(){const e=localStorage.getItem("token");if(this.isLoggedIn=!!e,this.isLoggedIn)try{const t=e.split(".")[1],n=t.replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(atob(n).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")),a=JSON.parse(o);console.log("Parsed JWT Payload:",a),a.sub&&a.sub.role?this.isAdmin="admin"===a.sub.role:this.isAdmin=!1,console.log("Is Admin:",this.isAdmin)}catch(t){console.error("Error parsing JWT:",t),this.isAdmin=!1}else this.isAdmin=!1},logout(){localStorage.removeItem("token"),this.isLoggedIn=!1,this.isAdmin=!1,this.$router.push("/login")}},mounted(){this.updateAuthStatus()}},m=n(1241);const h=(0,m.A)(c,[["render",u]]);var g=h,p=n(1387);const k=(0,a.Lk)("h2",null,"Add Knowledge Base Entry",-1);function f(e,t,n,r,s,l){return(0,a.uX)(),(0,a.CE)("div",null,[k,(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.data=e),placeholder:"Enter data..."},null,512),[[o.Jo,s.data]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.embedding=e),placeholder:"Enter embedding (optional, comma separated)"},null,512),[[o.Jo,s.embedding]]),(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.addItem&&l.addItem(...e))},"Add Item")])}var b={data(){return{data:"",embedding:""}},methods:{async addItem(){try{const e=localStorage.getItem("token"),t=await fetch("/knowledge_base",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({data:this.data,embedding:this.embedding?this.embedding.split(",").map(Number):null})});t.ok?(alert("Item added successfully!"),this.data="",this.embedding=""):alert("Failed to add item")}catch(e){console.error("Error adding item:",e)}}}};const y=(0,m.A)(b,[["render",f]]);var v=y,L=n(4232);const w=(0,a.Lk)("h2",null,"Search Knowledge Base",-1),E=(0,a.Lk)("h3",null,"Results",-1);function C(e,t,n,r,s,l){return(0,a.uX)(),(0,a.CE)("div",null,[w,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.searchKeyword=e),placeholder:"Enter keyword..."},null,512),[[o.Jo,s.searchKeyword]]),(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.fetchItems&&l.fetchItems(...e))},"Search"),E,(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.items,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id}," ID: "+(0,L.v_)(e.id)+", Data: "+(0,L.v_)(e.data)+", Embedding: "+(0,L.v_)(e.embedding?e.embedding.join(", "):"N/A"),1)))),128))])])}var I={data(){return{items:[],searchKeyword:""}},methods:{async fetchItems(){try{const e=localStorage.getItem("token");console.log("Searching for items with keyword:",this.searchKeyword);const t=await fetch(`/knowledge_base?keyword=${encodeURIComponent(this.searchKeyword)}`,{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(!t.ok)return void console.error(`Failed to fetch items: ${t.status} ${t.statusText}`);const n=await t.json();this.items=n}catch(e){console.error("Error fetching items:",e)}}}};const A=(0,m.A)(I,[["render",C]]);var S=A;const _=(0,a.Lk)("h2",null,"Update Knowledge Base Entry",-1);function U(e,t,n,r,s,l){return(0,a.uX)(),(0,a.CE)("div",null,[_,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.id=e),placeholder:"Enter ID..."},null,512),[[o.Jo,s.id]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.data=e),placeholder:"Enter new data..."},null,512),[[o.Jo,s.data]]),(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.embedding=e),placeholder:"Enter new embedding (comma separated)..."},null,512),[[o.Jo,s.embedding]]),(0,a.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>l.updateItem&&l.updateItem(...e))},"Update Entry")])}var T={data(){return{id:"",data:"",embedding:""}},methods:{async updateItem(){try{const e=localStorage.getItem("token"),t=await fetch(`/knowledge_base/${this.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({data:this.data,embedding:this.embedding.split(",").map(Number)})});if(!t.ok)return void console.error("Failed to update item:",t.statusText);alert("Entry updated successfully!")}catch(e){console.error("Error updating item:",e)}}}};const $=(0,m.A)(T,[["render",U]]);var X=$;const M=(0,a.Lk)("h2",null,"Delete Knowledge Base Entry",-1);function O(e,t,n,r,s,l){return(0,a.uX)(),(0,a.CE)("div",null,[M,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.id=e),placeholder:"Enter ID..."},null,512),[[o.Jo,s.id]]),(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.deleteItem&&l.deleteItem(...e))},"Delete Entry")])}var P={data(){return{id:""}},methods:{async deleteItem(){try{const e=localStorage.getItem("token"),t=await fetch(`/knowledge_base/${this.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}});if(!t.ok)return void console.error("Failed to delete item:",t.statusText);alert("Entry deleted successfully!")}catch(e){console.error("Error deleting item:",e)}}}};const J=(0,m.A)(P,[["render",O]]);var j=J;const D=(0,a.Lk)("h2",null,"Register",-1),F=(0,a.Lk)("button",{type:"submit"},"Register",-1);function R(e,t,n,r,s,l){return(0,a.uX)(),(0,a.CE)("div",null,[D,(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>l.register&&l.register(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.username=e),placeholder:"Username"},null,512),[[o.Jo,s.username]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.password=e),type:"password",placeholder:"Password"},null,512),[[o.Jo,s.password]]),F],32)])}var B=n(4373),K={data(){return{username:"",password:""}},methods:{async register(){try{await B.A.post("http://127.0.0.1:5000/register",{username:this.username,password:this.password}),alert("Registration successful!")}catch(e){console.error("Registration error:",e),alert("Registration failed.")}}}};const V=(0,m.A)(K,[["render",R]]);var W=V;const x=(0,a.Lk)("h2",null,"Login",-1),z=(0,a.Lk)("label",{for:"username"},"Username:",-1),N=(0,a.Lk)("label",{for:"password"},"Password:",-1),G=(0,a.Lk)("button",{type:"submit"},"Login",-1);function q(e,t,n,r,s,l){return(0,a.uX)(),(0,a.CE)("div",null,[x,(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>l.login&&l.login(...e)),["prevent"]))},[(0,a.Lk)("div",null,[z,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.username=e),type:"text",id:"username"},null,512),[[o.Jo,s.username]])]),(0,a.Lk)("div",null,[N,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.password=e),type:"password",id:"password"},null,512),[[o.Jo,s.password]])]),G],32)])}var Q={data(){return{username:"",password:""}},methods:{async login(){const e=await fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})});if(e.ok){const t=await e.json();localStorage.setItem("token",t.access_token),this.$router.push("/protected")}else alert("Login failed")}}};const H=(0,m.A)(Q,[["render",q]]);var Y=H;const Z=(0,a.Lk)("h2",null,"Protected Resource",-1),ee={key:0};function te(e,t,n,o,r,s){return(0,a.uX)(),(0,a.CE)("div",null,[Z,(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.fetchProtectedData&&s.fetchProtectedData(...e))},"Fetch Protected Data"),r.data?((0,a.uX)(),(0,a.CE)("div",ee,[(0,a.Lk)("pre",null,(0,L.v_)(r.data),1)])):(0,a.Q3)("",!0)])}var ne={data(){return{data:null}},created(){localStorage.getItem("token")||this.$router.push("/login")},methods:{async fetchProtectedData(){const e=localStorage.getItem("token"),t=await fetch("/protected",{method:"GET",headers:{Authorization:`Bearer ${e}`}});t.ok?this.data=await t.json():alert("Failed to fetch protected data.")}}};const oe=(0,m.A)(ne,[["render",te]]);var ae=oe;const re=(0,a.Lk)("h2",null,"User Management",-1),se=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"ID"),(0,a.Lk)("th",null,"Username"),(0,a.Lk)("th",null,"Role"),(0,a.Lk)("th",null,"Actions")])],-1),le=["onClick"],ie=["onClick"],de=["onClick"];function ue(e,t,n,o,r,s){return(0,a.uX)(),(0,a.CE)("div",null,[re,(0,a.Lk)("table",null,[se,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.users,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",null,(0,L.v_)(e.id),1),(0,a.Lk)("td",null,(0,L.v_)(e.username),1),(0,a.Lk)("td",null,(0,L.v_)(e.role),1),(0,a.Lk)("td",null,[(0,a.Lk)("button",{onClick:t=>s.changeRole(e.id)},"Change Role",8,le),(0,a.Lk)("button",{onClick:t=>s.changePassword(e.id)},"Change Password",8,ie),(0,a.Lk)("button",{onClick:t=>s.deleteUser(e.id)},"Delete",8,de)])])))),128))])])])}var ce={data(){return{users:[]}},methods:{async fetchUsers(){try{const e=await fetch("/users",{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),t=await e.json();console.log(t),this.users=t}catch(e){console.error("Error fetching users:",e)}},async changeRole(e){const t=prompt("Enter new role (user/admin):");await fetch(`/users/${e}/role`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({role:t})}),this.fetchUsers()},async changePassword(e){const t=prompt("Enter new password:");await fetch(`/users/${e}/password`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({password:t})}),alert("Password updated!")},async deleteUser(e){confirm("Are you sure you want to delete this user?")&&(await fetch(`/users/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),this.fetchUsers())}},mounted(){this.fetchUsers()}};const me=(0,m.A)(ce,[["render",ue]]);var he=me;const ge={class:"chat-container"},pe={class:"chat-messages"},ke={class:"chat-input-container"};function fe(e,t,n,r,s,l){const i=(0,a.g2)("Message");return(0,a.uX)(),(0,a.CE)("div",ge,[(0,a.Lk)("div",pe,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.messages,((e,t)=>((0,a.uX)(),(0,a.Wv)(i,{key:t,message:e},null,8,["message"])))),128))]),(0,a.Lk)("div",ke,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.userMessage=e),onKeyup:t[1]||(t[1]=(0,o.jR)(((...e)=>l.sendMessage&&l.sendMessage(...e)),["enter"])),placeholder:"Type your message...",class:"chat-input"},null,544),[[o.Jo,s.userMessage]]),(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.sendMessage&&l.sendMessage(...e)),class:"send-button"},"Send")])])}const be={class:"message-content"};function ye(e,t,n,o,r,s){return(0,a.uX)(),(0,a.CE)("div",{class:(0,L.C4)(s.messageClass)},[(0,a.Lk)("div",be,(0,L.v_)(n.message.content),1)],2)}var ve={props:["message"],computed:{messageClass(){return"user"===this.message.role?"message user-message":"message model-message"}}};const Le=(0,m.A)(ve,[["render",ye],["__scopeId","data-v-7a79bf97"]]);var we=Le,Ee={components:{Message:we},data(){return{userMessage:"",messages:[]}},methods:{async sendMessage(){if(""!==this.userMessage.trim()){this.messages.push({role:"user",content:this.userMessage});try{const e=localStorage.getItem("token"),t=await B.A.post("/chat",{message:this.userMessage},{headers:{Authorization:`Bearer ${e}`}});this.messages.push({role:"model",content:t.data.choices[0].message.content})}catch(e){console.error("Error sending message:",e)}this.userMessage=""}}}};const Ce=(0,m.A)(Ee,[["render",fe],["__scopeId","data-v-29b31060"]]);var Ie=Ce;const Ae=(0,a.Lk)("h2",null,"Data Management",-1);function Se(e,t,n,o,r,s){const l=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",null,[Ae,(0,a.Lk)("ul",null,[(0,a.Lk)("li",null,[(0,a.bF)(l,{to:"/add-item"},{default:(0,a.k6)((()=>[(0,a.eW)("Add Item")])),_:1})]),(0,a.Lk)("li",null,[(0,a.bF)(l,{to:"/delete-item"},{default:(0,a.k6)((()=>[(0,a.eW)("Delete Item")])),_:1})]),(0,a.Lk)("li",null,[(0,a.bF)(l,{to:"/get-items"},{default:(0,a.k6)((()=>[(0,a.eW)("Get Items")])),_:1})]),(0,a.Lk)("li",null,[(0,a.bF)(l,{to:"/update-item"},{default:(0,a.k6)((()=>[(0,a.eW)("Update Item")])),_:1})])])])}var _e={name:"DataManagement"};const Ue=(0,m.A)(_e,[["render",Se]]);var Te=Ue;function $e(e,t,n){const o=localStorage.getItem("token");if(o){const t=JSON.parse(atob(o.split(".")[1]));e.meta.requiresAdmin&&"admin"!==t.sub.role?n("/chat"):n()}else n("/login")}const Xe=(0,p.aE)({history:(0,p.LA)(),routes:[{path:"/",redirect:"/login"},{path:"/register",component:W},{path:"/login",component:Y},{path:"/protected",component:ae,beforeEnter:$e},{path:"/add-item",component:v,beforeEnter:$e},{path:"/get-items",component:S,beforeEnter:$e},{path:"/update-item",component:X,beforeEnter:$e},{path:"/delete-item",component:j,beforeEnter:$e},{path:"/user-management",component:he,beforeEnter:$e,meta:{requiresAdmin:!0}},{path:"/data-management",component:Te,beforeEnter:$e,meta:{requiresAdmin:!0}},{path:"/chat",component:Ie,beforeEnter:$e}]});var Me=Xe;(0,o.Ef)(g).use(Me).mount("#app")}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,a,r){if(!o){var s=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],r=e[u][2];for(var l=!0,i=0;i<o.length;i++)(!1&r||s>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[i])}))?o.splice(i--,1):(l=!1,r<s&&(s=r));if(l){e.splice(u--,1);var d=a();void 0!==d&&(t=d)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[o,a,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,r,s=o[0],l=o[1],i=o[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(i)var u=i(n)}for(t&&t(o);d<s.length;d++)r=s[d],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},o=self["webpackChunkrag_system_frontend"]=self["webpackChunkrag_system_frontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(3162)}));o=n.O(o)})();
//# sourceMappingURL=app.8f953057.js.map